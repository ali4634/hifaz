<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙØµÙ„ Ø­Ø§Ø¶Ø±ÛŒ Ùˆ Ø³Ø¨Ù‚ Ø±Ø¬Ø³Ù¹Ø±</title>
    <link href="https://fonts.googleapis.com/css2?family=Nafees&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --absent-color: #ffecec;
            --present-color: #e8f5e9;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Nafees', 'Noto Nastaliq Urdu', sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f5f7fa;
            direction: rtl;
            font-size: 13px;
            color: #333;
            line-height: 1.5;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        h1, h2, h3, h4, h5 {
            color: var(--dark-color);
            font-weight: 700;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 12px;
            font-size: 1.4em;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 12px;
            border-bottom: 1px solid #e0e0e0;
            gap: 5px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .tab {
            padding: 6px 12px;
            cursor: pointer;
            background-color: #f1f1f1;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            transition: all 0.3s ease;
            font-size: 0.85em;
            border: 1px solid #e0e0e0;
            border-bottom: none;
            white-space: nowrap;
        }
        
        .tab.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
            padding: 12px;
            background-color: white;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            border: 1px solid #e0e0e0;
            border-top: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .date-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 12px;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            font-size: 0.85em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .date-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .date-input {
            position: relative;
            display: inline-block;
        }
        
        .date-input input {
            padding: 6px 30px 6px 10px;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
            font-family: inherit;
            font-size: 0.85em;
            width: 140px;
        }
        
        .date-input i {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark-color);
            cursor: pointer;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
            font-size: 0.8em;
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        th, td {
            padding: 8px 10px;
            text-align: right;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: normal;
            position: sticky;
            top: 0;
            font-size: 0.85em;
        }
        
        tr.present-row {
            background-color: var(--present-color);
        }
        
        tr.absent-row {
            background-color: var(--absent-color);
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .attendance-check {
            transform: scale(1.1);
            cursor: pointer;
            margin: 0 3px;
            accent-color: var(--success-color);
        }
        
        .small-btn {
            padding: 5px 8px;
            margin: 2px;
            font-size: 0.75em;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 3px;
        }
        
        .small-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .add-btn {
            background-color: var(--success-color);
            color: white;
        }
        
        .delete-btn {
            background-color: var(--danger-color);
            color: white;
        }
        
        .view-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .whatsapp-btn {
            background-color: #25D366;
            color: white;
        }
        
        .comment-icon {
            color: var(--warning-color);
            cursor: pointer;
            font-size: 1.1em;
            transition: transform 0.2s;
        }
        
        .comment-icon:hover {
            transform: scale(1.1);
        }
        
        .quantity-icon {
            color: var(--primary-color);
            cursor: pointer;
            font-size: 0.9em;
            margin-right: 4px;
        }
        
        .section-selector {
            margin: 8px 0;
            padding: 6px 10px;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
            width: 180px;
            font-family: inherit;
            font-size: 0.85em;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        /* Ù…ÙˆÚˆÙ„ Ø§Ø³Ù¹Ø§Ø¦Ù„Ø² */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 15px;
            border: 1px solid #888;
            width: 90%;
            max-width: 450px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .close {
            color: #aaa;
            float: left;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        /* Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± Ú©Ø§Ø±ÚˆØ² */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .stat-card {
            background-color: white;
            padding: 12px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            text-align: center;
        }
        
        .stat-card h3 {
            margin-top: 0;
            color: var(--dark-color);
            font-size: 0.85em;
        }
        
        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        /* Ø±ÛŒÚ©Ø§Ø±Úˆ ÙÙ„Ù¹Ø±Ø² */
        .record-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        .record-selector {
            padding: 6px 10px;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
            font-family: inherit;
            font-size: 0.85em;
            min-width: 130px;
        }
        
        .year-selector-container {
            display: flex;
            gap: 4px;
        }
        
        .add-year-btn {
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 0 10px;
            cursor: pointer;
            font-size: 1.1em;
        }
        
        /* Ø®Ù„Ø§ØµÛ Ú©Ø§Ø±ÚˆØ² */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 8px;
            margin-top: 12px;
        }
        
        .summary-card {
            background-color: white;
            padding: 8px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            text-align: center;
        }
        
        .summary-card h5 {
            margin: 4px 0;
            font-size: 0.75em;
            color: var(--dark-color);
        }
        
        /* ÙÙˆÙ† Ù†Ù…Ø¨Ø± Ø§Ø³Ù¹Ø§Ø¦Ù„ */
        .phone-number {
            font-size: 0.75em;
            color: #666;
        }
        
        .edit-phone {
            cursor: pointer;
            margin-left: 4px;
        }
        
        /* Ù†Ù…Ø§ÛŒØ§Úº ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ† */
        .highlight-absent {
            border-left: 3px solid var(--danger-color);
        }
        
        /* Ù…Ù‚Ø¯Ø§Ø± Ú©ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .quantity-info {
            font-size: 0.65em;
            color: #666;
            margin-top: 2px;
            display: block;
        }
        
        /* Ø§Ù† Ù¾Ù¹ Ú¯Ø±ÙˆÙ¾ */
        .input-group {
            margin-bottom: 8px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: bold;
            font-size: 0.85em;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 6px;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
            font-family: inherit;
            font-size: 0.85em;
        }
        
        /* ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ Ø´ÛŒØ¦Ø± Ø¨Ù¹Ù† */
        .share-buttons {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            justify-content: center;
        }
        
        /* Ø®ÙˆØ¨ØµÙˆØ±Øª Ù¹ÛŒØ¨Ù„ ÛÛŒÚˆØ± */
        .table-header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        }
        
        /* Ø·Ù„Ø¨Ø§Ø¡ Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹ Ø§Ø³Ù¹Ø§Ø¦Ù„Ø² */
        .student-management {
            margin: 15px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
        }
        
        .student-list {
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 5px;
        }
        
        .student-item {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        
        .student-item:last-child {
            border-bottom: none;
        }
        
        /* Ú†Ú¾ÙˆÙ¹ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ†Ø² Ú©Û’ Ù„ÛŒÛ’ Ø±Ø³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø§ÛŒÚˆØ¬Ø³Ù¹Ù…Ù†Ù¹ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .stats-container {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            }
            
            .summary-cards {
                grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            }
            
            .record-filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .record-selector {
                width: 100%;
            }
            
            .date-input input {
                width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“– Ù…ÙØµÙ„ Ø­Ø§Ø¶Ø±ÛŒ Ùˆ Ø³Ø¨Ù‚ Ø±Ø¬Ø³Ù¹Ø±</h1>
        
        <select class="section-selector" id="section-selector">
            <option value="section1">Ø³ÛŒÚ©Ø´Ù† 1</option>
            <option value="section2">Ø³ÛŒÚ©Ø´Ù† 2</option>
            <option value="section3">Ø³ÛŒÚ©Ø´Ù† 3</option>
        </select>
        
        <div class="tabs">
            <div class="tab active" data-tab="attendance">Ø­Ø§Ø¶Ø±ÛŒ</div>
            <div class="tab" data-tab="stats">Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø±</div>
            <div class="tab" data-tab="absentees">ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ†</div>
            <div class="tab" data-tab="full-record">Ù…Ú©Ù…Ù„ Ø±ÛŒÚ©Ø§Ø±Úˆ</div>
            <div class="tab" data-tab="students">Ø·Ù„Ø¨Ø§Ø¡ Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹</div>
        </div>
        
        <div class="tab-content active" id="attendance-tab">
            <div class="date-header">
                <div class="date-selector">
                    <div class="date-input">
                        <input type="date" id="date-picker">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h2 id="current-date"></h2>
                </div>
            </div>
            
            <div style="overflow-x: auto;">
                <table id="attendance-table">
                    <thead>
                        <tr class="table-header">
                            <th width="25%">Ù†Ø§Ù…</th>
                            <th width="8%">Ø­Ø§Ø¶Ø±ÛŒ</th>
                            <th width="12%">Ø³Ø¨Ù‚</th>
                            <th width="12%">Ø³Ø¨Ù‚ÛŒ</th>
                            <th width="12%">Ù…Ù†Ø²Ù„</th>
                            <th width="8%">ØªØ¨ØµØ±Û</th>
                            <th width="23%">Ø¹Ù…Ù„</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ÚˆÛŒÙ¹Ø§ ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚ¯Ø§ -->
                    </tbody>
                </table>
            </div>
            
            <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                <button class="small-btn add-btn" id="save-btn">ğŸ’¾ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
                <button class="small-btn add-btn" id="export-btn">ğŸ“¤ ÚˆÛŒÙ¹Ø§ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø±ÛŒÚº</button>
                <input type="file" id="import-btn" style="display: none;" accept=".json"/>
                <button class="small-btn add-btn" onclick="document.getElementById('import-btn').click()">ğŸ“¥ ÚˆÛŒÙ¹Ø§ Ø§Ù…Ù¾ÙˆØ±Ù¹ Ú©Ø±ÛŒÚº</button>
            </div>
        </div>
        
        <div class="tab-content" id="stats-tab">
            <h2>Ø¢Ø¬ Ú©Ø§ Ø®Ù„Ø§ØµÛ</h2>
            
            <div class="stats-container">
                <div class="stat-card">
                    <h3>Ú©Ù„ Ø·Ù„Ø¨Ø§Ø¡</h3>
                    <div class="stat-value" id="total-students">0</div>
                </div>
                <div class="stat-card">
                    <h3>Ø­Ø§Ø¶Ø±ÛŒÙ†</h3>
                    <div class="stat-value" id="present-count">0</div>
                </div>
                <div class="stat-card">
                    <h3>ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ†</h3>
                    <div class="stat-value" id="absent-count">0</div>
                </div>
                <div class="stat-card">
                    <h3>Ø³Ø¨Ù‚ Ø³Ù†Ø§Ù†Û’ ÙˆØ§Ù„Û’</h3>
                    <div class="stat-value" id="lesson-count">0</div>
                </div>
                <div class="stat-card">
                    <h3>Ø³Ø¨Ù‚ÛŒ Ø³Ù†Ø§Ù†Û’ ÙˆØ§Ù„Û’</h3>
                    <div class="stat-value" id="homework-count">0</div>
                </div>
                <div class="stat-card">
                    <h3>Ù…Ù†Ø²Ù„ Ù…Ú©Ù…Ù„ Ú©Ø±Ù†Û’ ÙˆØ§Ù„Û’</h3>
                    <div class="stat-value" id="milestone-count">0</div>
                </div>
            </div>
            
            <h3>ØªÙØµÛŒÙ„ÛŒ Ø±Ù¾ÙˆØ±Ù¹</h3>
            <div style="overflow-x: auto;">
                <table class="report-table">
                    <thead>
                        <tr class="table-header">
                            <th>Ú©ÛŒÙ¹ÛŒÚ¯Ø±ÛŒ</th>
                            <th>ØªØ¹Ø¯Ø§Ø¯</th>
                            <th>ÙÛŒØµØ¯</th>
                            <th>Ù…Ù‚Ø¯Ø§Ø±</th>
                        </tr>
                    </thead>
                    <tbody id="stats-details">
                        <!-- Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚº Ú¯Û’ -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="tab-content" id="absentees-tab">
            <h2>Ú¯Ø²Ø´ØªÛ ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ†</h2>
            <div id="previous-absentees">
                <!-- ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ† Ú©ÛŒ ÙÛØ±Ø³Øª ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚ¯ÛŒ -->
            </div>
        </div>

        <div class="tab-content" id="full-record-tab">
            <h2>Ù…Ú©Ù…Ù„ Ø±ÛŒÚ©Ø§Ø±Úˆ</h2>
            
            <div class="record-filters">
                <div class="year-selector-container">
                    <select id="year-selector" class="record-selector">
                        <option value="">-- Ø³Ø§Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>
                        <!-- JavaScript Ø³Û’ Ø®ÙˆØ¯Ø¨Ø®ÙˆØ¯ Ø¨Ú¾Ø± Ø¬Ø§Ø¦Û’ Ú¯Ø§ -->
                    </select>
                    <button class="add-year-btn" id="add-year-btn">+</button>
                </div>
                
                <select id="month-selector" class="record-selector">
                    <option value="">-- Ù…ÛÛŒÙ†Û Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>
                    <!-- JavaScript Ø³Û’ Ø®ÙˆØ¯Ø¨Ø®ÙˆØ¯ Ø¨Ú¾Ø± Ø¬Ø§Ø¦Û’ Ú¯Ø§ -->
                </select>
                
                <select id="student-selector" class="record-selector">
                    <option value="">-- Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>
                    <!-- JavaScript Ø³Û’ Ø®ÙˆØ¯Ø¨Ø®ÙˆØ¯ Ø¨Ú¾Ø± Ø¬Ø§Ø¦Û’ Ú¯Ø§ -->
                </select>
                
                <button class="small-btn add-btn" id="load-record">Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</button>
            </div>
            
            <div id="full-record-result" style="display: none;">
                <div style="overflow-x: auto;">
                    <table class="report-table">
                        <thead>
                            <tr class="table-header">
                                <th>Ù†Ø§Ù…</th>
                                <th>ØªØ§Ø±ÛŒØ®</th>
                                <th>Ø­Ø§Ø¶Ø±ÛŒ</th>
                                <th>Ø³Ø¨Ù‚</th>
                                <th>Ø³Ø¨Ù‚ÛŒ</th>
                                <th>Ù…Ù†Ø²Ù„</th>
                                <th>ØªØ¨ØµØ±Û</th>
                                <th>Ø³Ø¨Ù‚ Ù…Ù‚Ø¯Ø§Ø±</th>
                                <th>Ø³Ø¨Ù‚ÛŒ Ù…Ù‚Ø¯Ø§Ø±</th>
                                <th>Ù…Ù†Ø²Ù„ Ù…Ù‚Ø¯Ø§Ø±</th>
                            </tr>
                        </thead>
                        <tbody id="record-data">
                            <!-- Ø±ÛŒÚ©Ø§Ø±Úˆ ÚˆÛŒÙ¹Ø§ ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚ¯Ø§ -->
                        </tbody>
                    </table>
                </div>
                
                <div class="record-summary">
                    <h3>Ø®Ù„Ø§ØµÛ</h3>
                    <div id="summary-stats">
                        <!-- Ø®Ù„Ø§ØµÛ Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚº Ú¯Û’ -->
                    </div>
                    
                    <div class="share-buttons">
                        <button class="small-btn whatsapp-btn" id="share-whatsapp">
                            <i class="fab fa-whatsapp"></i> ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ Ù¾Ø± Ø´ÛŒØ¦Ø± Ú©Ø±ÛŒÚº
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Ø·Ù„Ø¨Ø§Ø¡ Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹ Ù¹ÛŒØ¨ -->
        <div class="tab-content" id="students-tab">
            <h2>Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ Ø§Ù†ØªØ¸Ø§Ù…ÛŒÛ</h2>
            
            <div class="student-management">
                <h3>Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª</h3>
                <div class="input-group">
                    <input type="text" id="new-student-name" placeholder="Ù†ÛŒØ§ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù…">
                    <button class="small-btn add-btn" id="add-student-btn">Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</button>
                </div>
                
                <div class="student-list" id="student-list">
                    <!-- Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª ÛŒÛØ§Úº Ø¸Ø§ÛØ± ÛÙˆÚ¯ÛŒ -->
                </div>
                
                <div style="margin-top: 10px;">
                    <button class="small-btn delete-btn" id="clear-students-btn">ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h3>Ø¯Ø±Ø¢Ù…Ø¯/Ø¨Ø±Ø¢Ù…Ø¯</h3>
                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="small-btn add-btn" id="export-students-btn">Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø¨Ø±Ø¢Ù…Ø¯ Ú©Ø±ÛŒÚº</button>
                    <input type="file" id="import-students-btn" style="display: none;" accept=".json"/>
                    <button class="small-btn add-btn" onclick="document.getElementById('import-students-btn').click()">Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ø±ÛŒÚº</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªØ¨ØµØ±Û Ù…ÙˆÚˆÙ„ -->
    <div id="comment-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="comment-title">Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ ØªØ¨ØµØ±Û</h2>
            <textarea id="comment-text" rows="4" style="width: 100%; padding: 8px; border-radius: var(--border-radius); border: 1px solid #ddd;"></textarea>
            <button class="small-btn add-btn" id="save-comment" style="margin-top: 10px;">Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
        </div>
    </div>

    <!-- ÙÙˆÙ† Ù†Ù…Ø¨Ø± Ù…ÙˆÚˆÙ„ -->
    <div id="phone-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="phone-title">Ø³Ø±Ù¾Ø±Ø³Øª Ú©Ø§ ÙÙˆÙ† Ù†Ù…Ø¨Ø±</h2>
            <input type="text" id="phone-number" placeholder="">
            <button class="small-btn add-btn" id="save-phone" style="margin-top: 10px;">Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
        </div>
    </div>

    <!-- Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆÚˆÙ„ -->
    <div id="quantity-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="quantity-title">Ù…Ù‚Ø¯Ø§Ø± Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª</h2>
            <div class="input-group">
                <label for="lesson-quantity">Ø³Ø¨Ù‚ Ù…Ù‚Ø¯Ø§Ø±</label>
                <input type="text" id="lesson-quantity" placeholder="">
            </div>
            <div class="input-group">
                <label for="homework-quantity">Ø³Ø¨Ù‚ÛŒ Ù…Ù‚Ø¯Ø§Ø±</label>
                <input type="text" id="homework-quantity" placeholder="">
            </div>
            <div class="input-group">
                <label for="milestone-quantity">Ù…Ù†Ø²Ù„ Ù…Ù‚Ø¯Ø§Ø±</label>
                <input type="text" id="milestone-quantity" placeholder="">
            </div>
            <button class="small-btn add-btn" id="save-quantity" style="margin-top: 10px;">Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
        </div>
    </div>

    <!-- Ø±Ù¾ÙˆØ±Ù¹ Ù…ÙˆÚˆÙ„ -->
    <div id="report-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="report-title">Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©ÛŒ Ø±Ù¾ÙˆØ±Ù¹</h2>
            <div id="report-content">
                <table class="report-table">
                    <!-- Ø±Ù¾ÙˆØ±Ù¹ ÚˆÛŒÙ¹Ø§ ÛŒÛØ§Úº Ø¯Ø§Ø®Ù„ ÛÙˆÚ¯Ø§ -->
                </table>
            </div>
        </div>
    </div>

    <!-- Ù†ÛŒØ§ Ø³Ø§Ù„ Ø´Ø§Ù…Ù„ Ú©Ø±Ù†Û’ Ú©Ø§ Ù…ÙˆÚˆÙ„ -->
    <div id="year-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ù†ÛŒØ§ Ø³Ø§Ù„ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</h2>
            <input type="number" id="new-year" placeholder="" min="2023" max="2100" style="width: 100%; padding: 8px; border-radius: var(--border-radius); border: 1px solid #ddd; margin: 10px 0;">
            <button class="small-btn add-btn" id="save-year" style="margin-top: 10px;">Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
        </div>
    </div>

    <script>
        // ØªØ§Ø±ÛŒØ® Ú©Ø§ ØªØ¹ÛŒÙ†
        const currentDateElement = document.getElementById('current-date');
        let currentDate = new Date();
        let selectedStudentIndex = null;
        let currentField = '';
        
        // ÚˆÛŒÙ¹Ø§ ÚˆÚ¾Ø§Ù†Ú†Û
        let attendanceData = {
            sections: {
                section1: {
                    students: [],
                    attendance: {}
                },
                section2: {
                    students: [],
                    attendance: {}
                },
                section3: {
                    students: [],
                    attendance: {}
                }
            },
            studentDetails: {} // Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ Ø§Ø¶Ø§ÙÛŒ ØªÙØµÛŒÙ„Ø§Øª
        };

        // Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø´Ø±ÙˆØ¹ Ú©Ø±Ù†Û’ Ù¾Ø± ÚˆÛŒÙ¹Ø§ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº
        function initApp() {
            const savedData = localStorage.getItem('attendanceData');
            if (savedData) {
                try {
                    attendanceData = JSON.parse(savedData);
                    // ÛŒÙ‚ÛŒÙ†ÛŒ Ø¨Ù†Ø§Ø¦ÛŒÚº Ú©Û ØªÙ…Ø§Ù… Ø³ÛŒÚ©Ø´Ù†Ø² Ù…ÙˆØ¬ÙˆØ¯ ÛÛŒÚº
                    if (!attendanceData.sections.section1) attendanceData.sections.section1 = {students: [], attendance: {}};
                    if (!attendanceData.sections.section2) attendanceData.sections.section2 = {students: [], attendance: {}};
                    if (!attendanceData.sections.section3) attendanceData.sections.section3 = {students: [], attendance: {}};
                    if (!attendanceData.studentDetails) attendanceData.studentDetails = {};
                } catch (e) {
                    console.error("ÚˆÛŒÙ¹Ø§ Ù„ÙˆÚˆ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ:", e);
                    // Ø®Ø±Ø§Ø¨ ÚˆÛŒÙ¹Ø§ Ú©ÛŒ ØµÙˆØ±Øª Ù…ÛŒÚº ÚˆÛŒÙØ§Ù„Ù¹ ÚˆÛŒÙ¹Ø§ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚº
                    attendanceData = {
                        sections: {
                            section1: {students: [], attendance: {}},
                            section2: {students: [], attendance: {}},
                            section3: {students: [], attendance: {}}
                        },
                        studentDetails: {}
                    };
                }
            }
            
            updateDateDisplay();
            loadAttendanceData();
            renderStudentList();
            initializeRecordTab();
        }

        // ØªØ§Ø±ÛŒØ® Ú©ÛŒ Ø¸Ø§ÛØ±ÛŒ Ø´Ú©Ù„ Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
        function updateDateDisplay() {
            const datePicker = document.getElementById('date-picker');
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            datePicker.value = currentDate.toISOString().split('T')[0];
            currentDateElement.textContent = currentDate.toLocaleDateString('ur-PK', options);
        }

        // Ø­Ø§Ø¶Ø±ÛŒ Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº
        function loadAttendanceData() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const section = document.getElementById('section-selector').value;
            
            // Ø§Ú¯Ø± Ø§Ø³ ØªØ§Ø±ÛŒØ® Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ØªÙˆ Ù†ÛŒØ§ ÚˆÛŒÙ¹Ø§ Ø¨Ù†Ø§Ø¦ÛŒÚº
            if (!attendanceData.sections[section].attendance[dateStr]) {
                const newAttendance = attendanceData.sections[section].students.map(() => ({
                    present: true,
                    lesson: false,
                    homework: false,
                    milestone: false,
                    comment: '',
                    lessonQuantity: "",
                    homeworkQuantity: "",
                    milestoneQuantity: ""
                }));
                attendanceData.sections[section].attendance[dateStr] = newAttendance;
            }
            
            renderAttendanceTable();
            updateStats();
            highlightPreviousAbsentees();
        }

        // Ø­Ø§Ø¶Ø±ÛŒ Ú©ÛŒ Ù¹ÛŒØ¨Ù„ Ø±ÛŒÙ†ÚˆØ± Ú©Ø±ÛŒÚº
        function renderAttendanceTable() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const section = document.getElementById('section-selector').value;
            const tableBody = document.querySelector('#attendance-table tbody');
            tableBody.innerHTML = '';
            
            const students = attendanceData.sections[section].students;
            const attendanceRecords = attendanceData.sections[section].attendance[dateStr] || [];
            
            students.forEach((student, index) => {
                const record = attendanceRecords[index] || {
                    present: true,
                    lesson: false,
                    homework: false,
                    milestone: false,
                    comment: '',
                    lessonQuantity: "",
                    homeworkQuantity: "",
                    milestoneQuantity: ""
                };
                
                const row = document.createElement('tr');
                if (record.present) {
                    row.classList.add('present-row');
                } else {
                    row.classList.add('absent-row');
                }
                
                // Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª
                const studentDetail = attendanceData.studentDetails[student] || {};
                
                row.innerHTML = `
                    <td>
                        ${student}
                        <br>
                        <span class="phone-number">
                            <span class="edit-phone" data-student="${student}">âœï¸</span>
                            ${studentDetail.phone || 'ÙÙˆÙ† Ù†Ù…Ø¨Ø± Ù†ÛÛŒÚº'}
                        </span>
                    </td>
                    <td><input type="checkbox" class="attendance-check" ${record.present ? 'checked' : ''} data-field="present" data-index="${index}"></td>
                    <td>
                        <input type="checkbox" class="attendance-check" ${record.lesson ? 'checked' : ''} ${record.present ? '' : 'disabled'} data-field="lesson" data-index="${index}">
                        ${record.lesson && record.lessonQuantity ? `<span class="quantity-info">${record.lessonQuantity}</span>` : ''}
                        <i class="fas fa-info-circle quantity-icon" data-field="lesson" data-index="${index}"></i>
                    </td>
                    <td>
                        <input type="checkbox" class="attendance-check" ${record.homework ? 'checked' : ''} ${record.present ? '' : 'disabled'} data-field="homework" data-index="${index}">
                        ${record.homework && record.homeworkQuantity ? `<span class="quantity-info">${record.homeworkQuantity}</span>` : ''}
                        <i class="fas fa-info-circle quantity-icon" data-field="homework" data-index="${index}"></i>
                    </td>
                    <td>
                        <input type="checkbox" class="attendance-check" ${record.milestone ? 'checked' : ''} ${record.present ? '' : 'disabled'} data-field="milestone" data-index="${index}">
                        ${record.milestone && record.milestoneQuantity ? `<span class="quantity-info">${record.milestoneQuantity}</span>` : ''}
                        <i class="fas fa-info-circle quantity-icon" data-field="milestone" data-index="${index}"></i>
                    </td>
                    <td><span class="comment-icon" data-index="${index}">ğŸ’¬</span> ${record.comment ? 'âœ”' : ''}</td>
                    <td>
                        <button class="small-btn view-btn" data-student="${student}">Ø±Ù¾ÙˆØ±Ù¹</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            addEventListeners();
        }

        // Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø±ÛŒÙ†ÚˆØ± Ú©Ø±ÛŒÚº
        function renderStudentList() {
            const section = document.getElementById('section-selector').value;
            const studentList = document.getElementById('student-list');
            studentList.innerHTML = '';
            
            attendanceData.sections[section].students.forEach((student, index) => {
                const studentItem = document.createElement('div');
                studentItem.className = 'student-item';
                studentItem.innerHTML = `
                    <span>${student}</span>
                    <button class="small-btn delete-btn" data-index="${index}">Ø­Ø°Ù</button>
                `;
                studentList.appendChild(studentItem);
            });
            
            // Ø­Ø°Ù Ø¨Ù¹Ù† Ú©Û’ Ù„ÛŒÛ’ Ø§ÛŒÙˆÙ†Ù¹ Ù„Ø³Ù¹Ù†Ø±Ø²
            document.querySelectorAll('#student-list .delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.dataset.index;
                    const section = document.getElementById('section-selector').value;
                    const studentName = attendanceData.sections[section].students[index];
                    
                    if (confirm(`Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ ${studentName} Ú©Ùˆ Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ`)) {
                        attendanceData.sections[section].students.splice(index, 1);
                        
                        // ØªÙ…Ø§Ù… ØªØ§Ø±ÛŒØ®ÙˆÚº Ø³Û’ Ø§Ø³ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ø­Ø°Ù Ú©Ø±ÛŒÚº
                        for (const date in attendanceData.sections[section].attendance) {
                            if (attendanceData.sections[section].attendance[date][index]) {
                                attendanceData.sections[section].attendance[date].splice(index, 1);
                            }
                        }
                        
                        renderStudentList();
                        saveData();
                        loadAttendanceData();
                        updateStudentSelector();
                    }
                });
            });
        }

        // ÚˆÛŒÙ¹Ø§ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº
        function saveData() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
        }

        // Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
        function updateStats() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const section = document.getElementById('section-selector').value;
            
            const students = attendanceData.sections[section].students;
            const attendanceRecords = attendanceData.sections[section].attendance[dateStr] || [];
            
            const total = students.length;
            const present = attendanceRecords.filter(r => r?.present).length;
            const absent = total - present;
            const lesson = attendanceRecords.filter(r => r?.lesson).length;
            const homework = attendanceRecords.filter(r => r?.homework).length;
            const milestone = attendanceRecords.filter(r => r?.milestone).length;
            
            // Ù…Ù‚Ø¯Ø§Ø±ÙˆÚº Ú©Ø§ Ø­Ø³Ø§Ø¨
            let totalLessonQuantity = 0;
            let totalHomeworkQuantity = 0;
            let totalMilestoneQuantity = 0;
            
            attendanceRecords.forEach(record => {
                if (record?.lesson && record.lessonQuantity) {
                    const match = record.lessonQuantity.match(/\d+/);
                    if (match) totalLessonQuantity += parseInt(match[0]);
                }
                if (record?.homework && record.homeworkQuantity) {
                    const match = record.homeworkQuantity.match(/\d+/);
                    if (match) totalHomeworkQuantity += parseInt(match[0]);
                }
                if (record?.milestone && record.milestoneQuantity) {
                    const match = record.milestoneQuantity.match(/\d+/);
                    if (match) totalMilestoneQuantity += parseInt(match[0]);
                }
            });
            
            // Ú©Ø§Ø±ÚˆØ² Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
            document.getElementById('total-students').textContent = total;
            document.getElementById('present-count').textContent = present;
            document.getElementById('absent-count').textContent = absent;
            document.getElementById('lesson-count').textContent = lesson;
            document.getElementById('homework-count').textContent = homework;
            document.getElementById('milestone-count').textContent = milestone;
            
            // ØªÙØµÛŒÙ„ÛŒ Ø¬Ø¯ÙˆÙ„ Ø§Ù¾ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
            const statsDetails = document.getElementById('stats-details');
            statsDetails.innerHTML = '';
            
            const categories = [
                { name: 'Ø­Ø§Ø¶Ø±ÛŒ', value: present, total, quantity: '' },
                { name: 'Ø³Ø¨Ù‚', value: lesson, total: present, quantity: totalLessonQuantity > 0 ? `Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalLessonQuantity}` : '' },
                { name: 'Ø³Ø¨Ù‚ÛŒ', value: homework, total: present, quantity: totalHomeworkQuantity > 0 ? `Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalHomeworkQuantity}` : '' },
                { name: 'Ù…Ù†Ø²Ù„', value: milestone, total: present, quantity: totalMilestoneQuantity > 0 ? `Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalMilestoneQuantity}` : '' }
            ];
            
            categories.forEach(cat => {
                const row = document.createElement('tr');
                const percentage = cat.total > 0 ? Math.round((cat.value / cat.total) * 100) : 0;
                
                row.innerHTML = `
                    <td>${cat.name}</td>
                    <td>${cat.value}/${cat.total}</td>
                    <td>${percentage}%</td>
                    <td>${cat.quantity}</td>
                `;
                
                statsDetails.appendChild(row);
            });
        }

        // Ú¯Ø²Ø´ØªÛ ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ† Ú©Ùˆ Ù†Ù…Ø§ÛŒØ§Úº Ú©Ø±ÛŒÚº
        function highlightPreviousAbsentees() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const section = document.getElementById('section-selector').value;
            const yesterday = new Date(currentDate);
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];
            
            // ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ† Ú©ÛŒ ÙÛØ±Ø³Øª Ø¨Ù†Ø§Ø¦ÛŒÚº
            const absenteesList = document.getElementById('previous-absentees');
            absenteesList.innerHTML = '<p>Ú¯Ø²Ø´ØªÛ Ø¯Ù† Ú©Û’ ØºÛŒØ± Ø­Ø§Ø¶Ø±ÛŒÙ†:</p>';
            
            if (attendanceData.sections[section]?.attendance[yesterdayStr]) {
                const yesterdayRecords = attendanceData.sections[section].attendance[yesterdayStr];
                const yesterdayAbsentees = attendanceData.sections[section].students.filter((student, index) => {
                    return yesterdayRecords[index] && !yesterdayRecords[index].present;
                });
                
                if (yesterdayAbsentees.length > 0) {
                    const ul = document.createElement('ul');
                    yesterdayAbsentees.forEach(student => {
                        const li = document.createElement('li');
                        li.textContent = student;
                        ul.appendChild(li);
                    });
                    absenteesList.appendChild(ul);
                } else {
                    absenteesList.innerHTML += '<p>Ú©ÙˆØ¦ÛŒ ØºÛŒØ± Ø­Ø§Ø¶Ø± Ù†ÛÛŒÚº ØªÚ¾Ø§</p>';
                }
            } else {
                absenteesList.innerHTML += '<p>Ú©ÙˆØ¦ÛŒ ÚˆÛŒÙ¹Ø§ Ø¯Ø³ØªÛŒØ§Ø¨ Ù†ÛÛŒÚº</p>';
            }
        }

        // Ù…Ú©Ù…Ù„ Ø±ÛŒÚ©Ø§Ø±Úˆ Ù¹ÛŒØ¨ Ú©Û’ Ù„ÛŒÛ’ ÙÙ†Ú©Ø´Ù†Ø²
        function initializeRecordTab() {
            // Ø³Ø§Ù„ÙˆÚº Ú©Ø§ ÚˆØ±Ø§Ù¾ ÚˆØ§Ø¤Ù† Ø¨Ú¾Ø±ÛŒÚº
            const yearSelect = document.getElementById('year-selector');
            const currentYear = new Date().getFullYear();
            
            yearSelect.innerHTML = '<option value="">-- Ø³Ø§Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>';
            
            // 2020 Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯Û Ø³Ø§Ù„ + 5 ØªÚ© Ú©Û’ Ø³Ø§Ù„ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº
            for (let year = 2020; year <= currentYear + 5; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }
            
            // Ù…ÛÛŒÙ†ÙˆÚº Ú©Ø§ ÚˆØ±Ø§Ù¾ ÚˆØ§Ø¤Ù† Ø¨Ú¾Ø±ÛŒÚº
            const monthSelect = document.getElementById('month-selector');
            const months = [
                'Ø¬Ù†ÙˆØ±ÛŒ', 'ÙØ±ÙˆØ±ÛŒ', 'Ù…Ø§Ø±Ú†', 'Ø§Ù¾Ø±ÛŒÙ„', 'Ù…Ø¦ÛŒ', 'Ø¬ÙˆÙ†',
                'Ø¬ÙˆÙ„Ø§Ø¦ÛŒ', 'Ø§Ú¯Ø³Øª', 'Ø³ØªÙ…Ø¨Ø±', 'Ø§Ú©ØªÙˆØ¨Ø±', 'Ù†ÙˆÙ…Ø¨Ø±', 'Ø¯Ø³Ù…Ø¨Ø±'
            ];
            
            monthSelect.innerHTML = '<option value="">-- Ù…ÛÛŒÙ†Û Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>';
            months.forEach((month, index) => {
                const option = document.createElement('option');
                option.value = index + 1;
                option.textContent = month;
                monthSelect.appendChild(option);
            });
            
            // Ø·Ù„Ø¨Ø§Ø¡ Ú©Ø§ ÚˆØ±Ø§Ù¾ ÚˆØ§Ø¤Ù† Ø¨Ú¾Ø±ÛŒÚº
            updateStudentSelector();
        }
        
        function updateStudentSelector() {
            const studentSelect = document.getElementById('student-selector');
            const section = document.getElementById('section-selector').value;
            
            studentSelect.innerHTML = '<option value="">-- Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº --</option>';
            
            attendanceData.sections[section].students.forEach(student => {
                const option = document.createElement('option');
                option.value = student;
                option.textContent = student;
                studentSelect.appendChild(option);
            });
        }
        
        // Ø±ÛŒÚ©Ø§Ø±Úˆ Ù„ÙˆÚˆ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('load-record').addEventListener('click', function() {
            const year = document.getElementById('year-selector').value;
            const month = document.getElementById('month-selector').value;
            const student = document.getElementById('student-selector').value;
            const section = document.getElementById('section-selector').value;
            
            if (!year || !student) {
                alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø³Ø§Ù„ Ø§ÙˆØ± Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº');
                return;
            }
            
            loadStudentRecord(year, month, student, section);
        });
        
        function loadStudentRecord(year, month, studentName, section) {
            const recordData = document.getElementById('record-data');
            recordData.innerHTML = '';
            
            let totalPresent = 0;
            let totalLesson = 0;
            let totalHomework = 0;
            let totalMilestone = 0;
            let totalDays = 0;
            let totalLessonQuantity = 0;
            let totalHomeworkQuantity = 0;
            let totalMilestoneQuantity = 0;
            
            // ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ù…ÛŒÚº ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº
            for (const date in attendanceData.sections[section].attendance) {
                const dateObj = new Date(date);
                const recordYear = dateObj.getFullYear();
                const recordMonth = dateObj.getMonth() + 1;
                
                // Ø§Ú¯Ø± Ø³Ø§Ù„ Ø§ÙˆØ± Ù…ÛÛŒÙ†Û Ù…Ù…Ø§Ø«Ù„ ÛÙˆ
                if ((!year || recordYear == year) && (!month || recordMonth == month)) {
                    const studentIndex = attendanceData.sections[section].students.indexOf(studentName);
                    if (studentIndex !== -1) {
                        const record = attendanceData.sections[section].attendance[date][studentIndex];
                        if (record) {
                            totalDays++;
                            if (record.present) totalPresent++;
                            if (record.lesson) {
                                totalLesson++;
                                if (record.lessonQuantity) {
                                    const match = record.lessonQuantity.match(/\d+/);
                                    if (match) totalLessonQuantity += parseInt(match[0]);
                                }
                            }
                            if (record.homework) {
                                totalHomework++;
                                if (record.homeworkQuantity) {
                                    const match = record.homeworkQuantity.match(/\d+/);
                                    if (match) totalHomeworkQuantity += parseInt(match[0]);
                                }
                            }
                            if (record.milestone) {
                                totalMilestone++;
                                if (record.milestoneQuantity) {
                                    const match = record.milestoneQuantity.match(/\d+/);
                                    if (match) totalMilestoneQuantity += parseInt(match[0]);
                                }
                            }
                            
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${studentName}</td>
                                <td>${dateObj.toLocaleDateString('ur-PK')}</td>
                                <td>${record.present ? 'âœ”' : 'âœ˜'}</td>
                                <td>${record.lesson ? 'âœ”' : 'âœ˜'}</td>
                                <td>${record.homework ? 'âœ”' : 'âœ˜'}</td>
                                <td>${record.milestone ? 'âœ”' : 'âœ˜'}</td>
                                <td>${record.comment || '-'}</td>
                                <td>${record.lesson ? (record.lessonQuantity || '-') : '-'}</td>
                                <td>${record.homework ? (record.homeworkQuantity || '-') : '-'}</td>
                                <td>${record.milestone ? (record.milestoneQuantity || '-') : '-'}</td>
                            `;
                            recordData.appendChild(row);
                        }
                    }
                }
            }
            
            // Ø®Ù„Ø§ØµÛ Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
            const summaryStats = document.getElementById('summary-stats');
            summaryStats.innerHTML = `
                <h4>${studentName} Ú©Ø§ Ø®Ù„Ø§ØµÛ (${year}${month ? ' - ' + document.getElementById('month-selector').selectedOptions[0].text : ''})</h4>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h5>Ú©Ù„ Ø¯Ù†</h5>
                        <div class="stat-value">${totalDays}</div>
                    </div>
                    <div class="summary-card">
                        <h5>Ø­Ø§Ø¶Ø±ÛŒ</h5>
                        <div class="stat-value">${totalPresent} (${totalDays > 0 ? Math.round((totalPresent/totalDays)*100) : 0}%)</div>
                    </div>
                    <div class="summary-card">
                        <h5>Ø³Ø¨Ù‚</h5>
                        <div class="stat-value">${totalLesson} (${totalPresent > 0 ? Math.round((totalLesson/totalPresent)*100) : 0}%)</div>
                        ${totalLessonQuantity > 0 ? `<div class="quantity-info">Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalLessonQuantity}</div>` : ''}
                    </div>
                    <div class="summary-card">
                        <h5>Ø³Ø¨Ù‚ÛŒ</h5>
                        <div class="stat-value">${totalHomework} (${totalPresent > 0 ? Math.round((totalHomework/totalPresent)*100) : 0}%)</div>
                        ${totalHomeworkQuantity > 0 ? `<div class="quantity-info">Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalHomeworkQuantity}</div>` : ''}
                    </div>
                    <div class="summary-card">
                        <h5>Ù…Ù†Ø²Ù„</h5>
                        <div class="stat-value">${totalMilestone} (${totalPresent > 0 ? Math.round((totalMilestone/totalPresent)*100) : 0}%)</div>
                        ${totalMilestoneQuantity > 0 ? `<div class="quantity-info">Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalMilestoneQuantity}</div>` : ''}
                    </div>
                </div>
            `;
            
            document.getElementById('full-record-result').style.display = 'block';
        }

        // ÚˆÛŒÙ¹Ø§ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹/Ø§Ù…Ù¾ÙˆØ±Ù¹ Ú©Ø§ Ù†Ø¸Ø§Ù…
        function exportData() {
            const dataStr = JSON.stringify(attendanceData);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportName = 'Ø­Ø§Ø¶Ø±ÛŒ_ÚˆÛŒÙ¹Ø§_' + new Date().toISOString().split('T')[0] + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportName);
            linkElement.click();
        }
        
        function importData(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const contents = e.target.result;
                    const importedData = JSON.parse(contents);
                    
                    if (importedData.sections && importedData.studentDetails) {
                        attendanceData = importedData;
                        localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                        initApp();
                        alert('ÚˆÛŒÙ¹Ø§ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ù„ÙˆÚˆ ÛÙˆ Ú¯ÛŒØ§!');
                    } else {
                        alert('ØºÙ„Ø· ÚˆÛŒÙ¹Ø§ ÙØ§Ø¦Ù„Û” Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯Ø±Ø³Øª JSON ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”');
                    }
                } catch (error) {
                    console.error('Ø¯Ø±Ø¢Ù…Ø¯ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ:', error);
                    alert('ÙØ§Ø¦Ù„ Ù¾Ú‘Ú¾Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒÛ” Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”');
                }
            };
            
            reader.readAsText(file);
        }

        // Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø¨Ø±Ø¢Ù…Ø¯/Ø¯Ø±Ø¢Ù…Ø¯
        function exportStudents() {
            const section = document.getElementById('section-selector').value;
            const dataToExport = {
                students: attendanceData.sections[section].students,
                studentDetails: attendanceData.studentDetails
            };
            
            const dataStr = JSON.stringify(dataToExport);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportName = 'Ø·Ù„Ø¨Ø§Ø¡_ÙÛØ±Ø³Øª_' + section + '_' + new Date().toISOString().split('T')[0] + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportName);
            linkElement.click();
        }
        
        function importStudents(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            const section = document.getElementById('section-selector').value;
            
            reader.onload = function(e) {
                try {
                    const contents = e.target.result;
                    const importedData = JSON.parse(contents);
                    
                    if (Array.isArray(importedData.students) && importedData.studentDetails) {
                        attendanceData.sections[section].students = importedData.students;
                        attendanceData.studentDetails = importedData.studentDetails;
                        
                        saveData();
                        renderStudentList();
                        loadAttendanceData();
                        updateStudentSelector();
                        alert('Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ù„ÙˆÚˆ ÛÙˆ Ú¯Ø¦ÛŒ!');
                    } else {
                        alert('ØºÙ„Ø· ÚˆÛŒÙ¹Ø§ ÙØ§Ø¦Ù„Û” Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯Ø±Ø³Øª JSON ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”');
                    }
                } catch (error) {
                    console.error('Ø¯Ø±Ø¢Ù…Ø¯ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ:', error);
                    alert('ÙØ§Ø¦Ù„ Ù¾Ú‘Ú¾Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒÛ” Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”');
                }
            };
            
            reader.readAsText(file);
        }

        // Ø§ÛŒÙˆÙ†Ù¹ Ù„Ø³Ù¹Ù†Ø±Ø² Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº
        function addEventListeners() {
            // Ú†ÛŒÚ© Ø¨Ø§Ú©Ø³Ø² Ú©Û’ Ù„ÛŒÛ’
            document.querySelectorAll('.attendance-check').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const dateStr = currentDate.toISOString().split('T')[0];
                    const section = document.getElementById('section-selector').value;
                    const index = this.dataset.index;
                    const field = this.dataset.field;
                    
                    attendanceData.sections[section].attendance[dateStr][index][field] = this.checked;
                    
                    // Ø§Ú¯Ø± Ø­Ø§Ø¶Ø±ÛŒ ØºÛŒØ± Ú†ÛŒÚ© ÛÙˆ ØªÙˆ Ø¯ÛŒÚ¯Ø± ÙÛŒÙ„ÚˆØ² ØºÛŒØ± ÙØ¹Ø§Ù„ ÛÙˆ Ø¬Ø§Ø¦ÛŒÚº
                    if (field === 'present') {
                        const row = this.closest('tr');
                        const lessonCheck = row.querySelector('[data-field="lesson"]');
                        const homeworkCheck = row.querySelector('[data-field="homework"]');
                        const milestoneCheck = row.querySelector('[data-field="milestone"]');
                        
                        lessonCheck.disabled = !this.checked;
                        homeworkCheck.disabled = !this.checked;
                        milestoneCheck.disabled = !this.checked;
                        
                        if (!this.checked) {
                            lessonCheck.checked = false;
                            homeworkCheck.checked = false;
                            milestoneCheck.checked = false;
                            attendanceData.sections[section].attendance[dateStr][index].lesson = false;
                            attendanceData.sections[section].attendance[dateStr][index].homework = false;
                            attendanceData.sections[section].attendance[dateStr][index].milestone = false;
                        }
                        
                        // Ù‚Ø·Ø§Ø± Ú©Ø§ Ø±Ù†Ú¯ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±ÛŒÚº
                        if (this.checked) {
                            row.classList.remove('absent-row');
                            row.classList.add('present-row');
                        } else {
                            row.classList.remove('present-row');
                            row.classList.add('absent-row');
                        }
                    }
                    
                    saveData();
                    updateStats();
                });
            });
            
            // ØªØ¨ØµØ±Û Ø¢Ø¦ÛŒÚ©Ù† Ú©Û’ Ù„ÛŒÛ’
            document.querySelectorAll('.comment-icon').forEach(icon => {
                icon.addEventListener('click', function() {
                    const dateStr = currentDate.toISOString().split('T')[0];
                    const section = document.getElementById('section-selector').value;
                    const index = this.dataset.index;
                    
                    selectedStudentIndex = index;
                    const studentName = attendanceData.sections[section].students[index];
                    const comment = attendanceData.sections[section].attendance[dateStr][index].comment || '';
                    
                    document.getElementById('comment-title').textContent = `${studentName} Ú©Ø§ ØªØ¨ØµØ±Û`;
                    document.getElementById('comment-text').value = comment;
                    document.getElementById('comment-modal').style.display = 'block';
                });
            });
            
            // ÙÙˆÙ† Ù†Ù…Ø¨Ø± Ø§ÛŒÚˆÛŒÙ¹ Ú©Û’ Ù„ÛŒÛ’
            document.querySelectorAll('.edit-phone').forEach(editBtn => {
                editBtn.addEventListener('click', function() {
                    const studentName = this.dataset.student;
                    const phone = attendanceData.studentDetails[studentName]?.phone || '';
                    
                    document.getElementById('phone-title').textContent = `${studentName} Ú©Ø§ ÙÙˆÙ† Ù†Ù…Ø¨Ø±`;
                    document.getElementById('phone-number').value = phone;
                    document.getElementById('phone-modal').style.display = 'block';
                    
                    // Ù…Ù†ØªØ®Ø¨ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ùˆ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº
                    selectedStudentIndex = attendanceData.sections[document.getElementById('section-selector').value].students.indexOf(studentName);
                });
            });
            
            // Ù…Ù‚Ø¯Ø§Ø± Ø¢Ø¦ÛŒÚ©Ù† Ú©Û’ Ù„ÛŒÛ’
            document.querySelectorAll('.quantity-icon').forEach(icon => {
                icon.addEventListener('click', function() {
                    const dateStr = currentDate.toISOString().split('T')[0];
                    const section = document.getElementById('section-selector').value;
                    const index = this.dataset.index;
                    const field = this.dataset.field;
                    
                    selectedStudentIndex = index;
                    currentField = field;
                    const studentName = attendanceData.sections[section].students[index];
                    const quantity = attendanceData.sections[section].attendance[dateStr][index][`${field}Quantity`] || '';
                    
                    document.getElementById('quantity-title').textContent = `${studentName} Ú©ÛŒ Ù…Ù‚Ø¯Ø§Ø± Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª`;
                    
                    // ØªÙ…Ø§Ù… Ù…Ù‚Ø¯Ø§Ø± ÙÛŒÙ„ÚˆØ² Ú©Ùˆ ØµØ§Ù Ú©Ø±ÛŒÚº
                    document.getElementById('lesson-quantity').value = '';
                    document.getElementById('homework-quantity').value = '';
                    document.getElementById('milestone-quantity').value = '';
                    
                    // Ù…ØªØ¹Ù„Ù‚Û ÙÛŒÙ„Úˆ Ú©Ùˆ Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº
                    if (field === 'lesson') {
                        document.getElementById('lesson-quantity').value = quantity;
                    } else if (field === 'homework') {
                        document.getElementById('homework-quantity').value = quantity;
                    } else if (field === 'milestone') {
                        document.getElementById('milestone-quantity').value = quantity;
                    }
                    
                    document.getElementById('quantity-modal').style.display = 'block';
                });
            });
            
            // Ø±Ù¾ÙˆØ±Ù¹ Ø¨Ù¹Ù† Ú©Û’ Ù„ÛŒÛ’
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const studentName = this.dataset.student;
                    const section = document.getElementById('section-selector').value;
                    
                    document.getElementById('report-title').textContent = `${studentName} Ú©ÛŒ Ø±Ù¾ÙˆØ±Ù¹`;
                    
                    // Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù…Ú©Ù…Ù„ Ø±ÛŒÚ©Ø§Ø±Úˆ ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº
                    let totalDays = 0;
                    let presentDays = 0;
                    let lessonDays = 0;
                    let homeworkDays = 0;
                    let milestoneDays = 0;
                    let lastComment = '';
                    let totalLessonQuantity = 0;
                    let totalHomeworkQuantity = 0;
                    let totalMilestoneQuantity = 0;
                    
                    const studentIndex = attendanceData.sections[section].students.indexOf(studentName);
                    if (studentIndex !== -1) {
                        for (const date in attendanceData.sections[section].attendance) {
                            const record = attendanceData.sections[section].attendance[date][studentIndex];
                            if (record) {
                                totalDays++;
                                if (record.present) presentDays++;
                                if (record.lesson) {
                                    lessonDays++;
                                    if (record.lessonQuantity) {
                                        const match = record.lessonQuantity.match(/\d+/);
                                        if (match) totalLessonQuantity += parseInt(match[0]);
                                    }
                                }
                                if (record.homework) {
                                    homeworkDays++;
                                    if (record.homeworkQuantity) {
                                        const match = record.homeworkQuantity.match(/\d+/);
                                        if (match) totalHomeworkQuantity += parseInt(match[0]);
                                    }
                                }
                                if (record.milestone) {
                                    milestoneDays++;
                                    if (record.milestoneQuantity) {
                                        const match = record.milestoneQuantity.match(/\d+/);
                                        if (match) totalMilestoneQuantity += parseInt(match[0]);
                                    }
                                }
                                if (record.comment) lastComment = record.comment;
                            }
                        }
                    }
                    
                    const reportContent = document.querySelector('#report-content table');
                    reportContent.innerHTML = `
                        <tr>
                            <th>Ú©Ù„ Ø¯Ù†</th>
                            <td>${totalDays}</td>
                        </tr>
                        <tr>
                            <th>Ø­Ø§Ø¶Ø±ÛŒ</th>
                            <td>${presentDays} (${totalDays > 0 ? Math.round((presentDays/totalDays)*100) : 0}%)</td>
                        </tr>
                        <tr>
                            <th>Ø³Ø¨Ù‚</th>
                            <td>${lessonDays} (${presentDays > 0 ? Math.round((lessonDays/presentDays)*100) : 0}%)</td>
                        </tr>
                        <tr>
                            <th>Ø³Ø¨Ù‚ Ú©ÛŒ Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±</th>
                            <td>${totalLessonQuantity > 0 ? totalLessonQuantity : "-"}</td>
                        </tr>
                        <tr>
                            <th>Ø³Ø¨Ù‚ÛŒ</th>
                            <td>${homeworkDays} (${presentDays > 0 ? Math.round((homeworkDays/presentDays)*100) : 0}%)</td>
                        </tr>
                        <tr>
                            <th>Ø³Ø¨Ù‚ÛŒ Ú©ÛŒ Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±</th>
                            <td>${totalHomeworkQuantity > 0 ? totalHomeworkQuantity : "-"}</td>
                        </tr>
                        <tr>
                            <th>Ù…Ù†Ø²Ù„</th>
                            <td>${milestoneDays} (${presentDays > 0 ? Math.round((milestoneDays/presentDays)*100) : 0}%)</td>
                        </tr>
                        <tr>
                            <th>Ù…Ù†Ø²Ù„ Ú©ÛŒ Ú©Ù„ Ù…Ù‚Ø¯Ø§Ø±</th>
                            <td>${totalMilestoneQuantity > 0 ? totalMilestoneQuantity : "-"}</td>
                        </tr>
                        <tr>
                            <th>Ø¢Ø®Ø±ÛŒ ØªØ¨ØµØ±Û</th>
                            <td>${lastComment || 'Ú©ÙˆØ¦ÛŒ ØªØ¨ØµØ±Û Ù†ÛÛŒÚº'}</td>
                        </tr>
                    `;
                    
                    document.getElementById('report-modal').style.display = 'block';
                });
            });
        }
        
        // Ù…ÙˆÚˆÙ„ Ø¨Ù†Ø¯ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });
        
        // ØªØ¨ØµØ±Û Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('save-comment').addEventListener('click', function() {
            if (selectedStudentIndex !== null) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const section = document.getElementById('section-selector').value;
                const comment = document.getElementById('comment-text').value;
                
                attendanceData.sections[section].attendance[dateStr][selectedStudentIndex].comment = comment;
                saveData();
                renderAttendanceTable();
                document.getElementById('comment-modal').style.display = 'none';
            }
        });
        
        // ÙÙˆÙ† Ù†Ù…Ø¨Ø± Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('save-phone').addEventListener('click', function() {
            if (selectedStudentIndex !== null) {
                const section = document.getElementById('section-selector').value;
                const studentName = attendanceData.sections[section].students[selectedStudentIndex];
                const phone = document.getElementById('phone-number').value;
                
                if (!attendanceData.studentDetails[studentName]) {
                    attendanceData.studentDetails[studentName] = {};
                }
                
                attendanceData.studentDetails[studentName].phone = phone;
                saveData();
                renderAttendanceTable();
                document.getElementById('phone-modal').style.display = 'none';
            }
        });
        
        // Ù…Ù‚Ø¯Ø§Ø± Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('save-quantity').addEventListener('click', function() {
            if (selectedStudentIndex !== null && currentField) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const section = document.getElementById('section-selector').value;
                
                if (currentField === 'lesson') {
                    attendanceData.sections[section].attendance[dateStr][selectedStudentIndex].lessonQuantity = document.getElementById('lesson-quantity').value;
                } else if (currentField === 'homework') {
                    attendanceData.sections[section].attendance[dateStr][selectedStudentIndex].homeworkQuantity = document.getElementById('homework-quantity').value;
                } else if (currentField === 'milestone') {
                    attendanceData.sections[section].attendance[dateStr][selectedStudentIndex].milestoneQuantity = document.getElementById('milestone-quantity').value;
                }
                
                saveData();
                renderAttendanceTable();
                document.getElementById('quantity-modal').style.display = 'none';
            }
        });
        
        // Ù†ÛŒØ§ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ø´Ø§Ù…Ù„ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('add-student-btn').addEventListener('click', function() {
            const name = document.getElementById('new-student-name').value.trim();
            if (name) {
                const section = document.getElementById('section-selector').value;
                
                // Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ Ù†Û ÛÙˆ
                if (!attendanceData.sections[section].students.includes(name)) {
                    attendanceData.sections[section].students.push(name);
                    
                    // Ù†Ø¦Û’ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Û’ Ù„ÛŒÛ’ ÚˆÛŒÙØ§Ù„Ù¹ ÚˆÛŒÙ¹Ø§ Ø¨Ù†Ø§Ø¦ÛŒÚº ØªÙ…Ø§Ù… ØªØ§Ø±ÛŒØ®ÙˆÚº Ù…ÛŒÚº
                    const currentDateStr = currentDate.toISOString().split('T')[0];
                    for (const date in attendanceData.sections[section].attendance) {
                        attendanceData.sections[section].attendance[date].push({
                            present: true,
                            lesson: false,
                            homework: false,
                            milestone: false,
                            comment: '',
                            lessonQuantity: "",
                            homeworkQuantity: "",
                            milestoneQuantity: ""
                        });
                    }
                    
                    // Ø§Ú¯Ø± Ø¢Ø¬ Ú©ÛŒ ØªØ§Ø±ÛŒØ® Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†Û ÛÙˆ ØªÙˆ Ø¨Ù†Ø§Ø¦ÛŒÚº
                    if (!attendanceData.sections[section].attendance[currentDateStr]) {
                        attendanceData.sections[section].attendance[currentDateStr] = 
                            attendanceData.sections[section].students.map(() => ({
                                present: true,
                                lesson: false,
                                homework: false,
                                milestone: false,
                                comment: '',
                                lessonQuantity: "",
                                homeworkQuantity: "",
                                milestoneQuantity: ""
                            }));
                    }
                    
                    document.getElementById('new-student-name').value = '';
                    renderStudentList();
                    saveData();
                    loadAttendanceData();
                    updateStudentSelector();
                } else {
                    alert('ÛŒÛ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ ÛÛ’');
                }
            } else {
                alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ù†Ø§Ù… Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
            }
        });
        
        // ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ Ø­Ø°Ù Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('clear-students-btn').addEventListener('click', function() {
            const section = document.getElementById('section-selector').value;
            if (confirm('Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ø§Ø¡ Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ ØªÙ…Ø§Ù… Ø­Ø§Ø¶Ø±ÛŒ Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ø¨Ú¾ÛŒ Ø­Ø°Ù ÛÙˆ Ø¬Ø§Ø¦Û’ Ú¯Ø§Û”')) {
                attendanceData.sections[section].students = [];
                attendanceData.sections[section].attendance = {};
                renderStudentList();
                saveData();
                loadAttendanceData();
                updateStudentSelector();
            }
        });
        
        // Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø¨Ø±Ø¢Ù…Ø¯ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('export-students-btn').addEventListener('click', exportStudents);
        
        // Ø·Ù„Ø¨Ø§Ø¡ Ú©ÛŒ ÙÛØ±Ø³Øª Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.getElementById('import-students-btn').addEventListener('change', importStudents);
        
        // ØªØ§Ø±ÛŒØ® Ù¾Ú©ÙØ± Ú©Û’ Ù„ÛŒÛ’ Ø§ÛŒÙˆÙ†Ù¹ Ù„Ø³Ù¹Ù†Ø±
        document.getElementById('date-picker').addEventListener('change', function() {
            const selectedDate = new Date(this.value);
            if (!isNaN(selectedDate.getTime())) {
                currentDate = selectedDate;
                updateDateDisplay();
                loadAttendanceData();
            }
        });
        
        // Ø³ÛŒÚ©Ø´Ù† ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ù†Û’ Ù¾Ø±
        document.getElementById('section-selector').addEventListener('change', function() {
            renderStudentList();
            loadAttendanceData();
            updateStudentSelector();
        });
        
        // Ù¹ÛŒØ¨Ø² Ú©Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // ØªÙ…Ø§Ù… Ù¹ÛŒØ¨Ø² Ø§ÙˆØ± Ù…ÙˆØ§Ø¯ Ú©Ùˆ ØºÛŒØ± ÙØ¹Ø§Ù„ Ú©Ø±ÛŒÚº
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Ù…Ù†ØªØ®Ø¨ Ù¹ÛŒØ¨ Ø§ÙˆØ± Ù…ÙˆØ§Ø¯ Ú©Ùˆ ÙØ¹Ø§Ù„ Ú©Ø±ÛŒÚº
                this.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                // Ø§Ú¯Ø± Ù…Ú©Ù…Ù„ Ø±ÛŒÚ©Ø§Ø±Úˆ Ù¹ÛŒØ¨ ÛÙˆ ØªÙˆ Ø§Ø³Û’ Ø§Ù†ÛŒØ´ÛŒÙ„Ø§Ø¦Ø² Ú©Ø±ÛŒÚº
                if (tabId === 'full-record') {
                    initializeRecordTab();
                }
            });
        });
        
        // ÚˆÛŒÙ¹Ø§ Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Û’ Ú©Ø§ Ø¨Ù¹Ù†
        document.getElementById('save-btn').addEventListener('click', function() {
            saveData();
            alert('ÚˆÛŒÙ¹Ø§ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ù…Ø­ÙÙˆØ¸ ÛÙˆ Ú¯ÛŒØ§!');
        });
        
        // ÚˆÛŒÙ¹Ø§ Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø§ Ø¨Ù¹Ù†
        document.getElementById('export-btn').addEventListener('click', exportData);
        
        // ÚˆÛŒÙ¹Ø§ Ø§Ù…Ù¾ÙˆØ±Ù¹ Ú©Ø§ Ø¨Ù¹Ù†
        document.getElementById('import-btn').addEventListener('change', importData);
        
        // Ù†ÛŒØ§ Ø³Ø§Ù„ Ø´Ø§Ù…Ù„ Ú©Ø±Ù†Û’ Ú©Ø§ Ø¨Ù¹Ù†
        document.getElementById('add-year-btn').addEventListener('click', function() {
            document.getElementById('year-modal').style.display = 'block';
        });
        
        // Ù†ÛŒØ§ Ø³Ø§Ù„ Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Û’ Ú©Ø§ Ø¨Ù¹Ù†
        document.getElementById('save-year').addEventListener('click', function() {
            const newYear = parseInt(document.getElementById('new-year').value);
            const yearSelect = document.getElementById('year-selector');
            
            if (newYear && !isNaN(newYear) && newYear >= 2023 && newYear <= 2100) {
                // Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ú©Û ÛŒÛ Ø³Ø§Ù„ Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ ØªÙˆ Ù†ÛÛŒÚº
                let yearExists = false;
                for (let i = 0; i < yearSelect.options.length; i++) {
                    if (parseInt(yearSelect.options[i].value) === newYear) {
                        yearExists = true;
                        break;
                    }
                }
                
                if (!yearExists) {
                    const option = document.createElement('option');
                    option.value = newYear;
                    option.textContent = newYear;
                    yearSelect.appendChild(option);
                    option.selected = true;
                    alert(`Ø³Ø§Ù„ ${newYear} Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ø´Ø§Ù…Ù„ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§ ÛÛ’`);
                } else {
                    alert('ÛŒÛ Ø³Ø§Ù„ Ù¾ÛÙ„Û’ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯ ÛÛ’');
                }
                
                document.getElementById('year-modal').style.display = 'none';
                document.getElementById('new-year').value = '';
            } else {
                alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… 2023 Ø³Û’ 2100 Ú©Û’ Ø¯Ø±Ù…ÛŒØ§Ù† Ø§ÛŒÚ© Ø¯Ø±Ø³Øª Ø³Ø§Ù„ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº');
            }
        });
        
        // ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ Ø´ÛŒØ¦Ø± Ø¨Ù¹Ù†
        document.getElementById('share-whatsapp').addEventListener('click', function() {
            const studentName = document.getElementById('student-selector').value;
            const year = document.getElementById('year-selector').value;
            const month = document.getElementById('month-selector').value;
            const section = document.getElementById('section-selector').value;
            
            if (!studentName) {
                alert('Ø¨Ø±Ø§Û Ú©Ø±Ù… Ù¾ÛÙ„Û’ Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº');
                return;
            }
            
            // Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù… Ú©Ø§ Ø±ÛŒÚ©Ø§Ø±Úˆ ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº
            let totalDays = 0;
            let presentDays = 0;
            let lessonDays = 0;
            let homeworkDays = 0;
            let milestoneDays = 0;
            let totalLessonQuantity = 0;
            let totalHomeworkQuantity = 0;
            let totalMilestoneQuantity = 0;
            
            const studentIndex = attendanceData.sections[section].students.indexOf(studentName);
            if (studentIndex !== -1) {
                for (const date in attendanceData.sections[section].attendance) {
                    const dateObj = new Date(date);
                    const recordYear = dateObj.getFullYear();
                    const recordMonth = dateObj.getMonth() + 1;
                    
                    if ((!year || recordYear == year) && (!month || recordMonth == month)) {
                        const record = attendanceData.sections[section].attendance[date][studentIndex];
                        if (record) {
                            totalDays++;
                            if (record.present) presentDays++;
                            if (record.lesson) {
                                lessonDays++;
                                if (record.lessonQuantity) {
                                    const match = record.lessonQuantity.match(/\d+/);
                                    if (match) totalLessonQuantity += parseInt(match[0]);
                                }
                            }
                            if (record.homework) {
                                homeworkDays++;
                                if (record.homeworkQuantity) {
                                    const match = record.homeworkQuantity.match(/\d+/);
                                    if (match) totalHomeworkQuantity += parseInt(match[0]);
                                }
                            }
                            if (record.milestone) {
                                milestoneDays++;
                                if (record.milestoneQuantity) {
                                    const match = record.milestoneQuantity.match(/\d+/);
                                    if (match) totalMilestoneQuantity += parseInt(match[0]);
                                }
                            }
                        }
                    }
                }
            }
            
            const summaryText = `
*${studentName} Ú©ÛŒ Ø±Ù¾ÙˆØ±Ù¹ (${year}${month ? ' - ' + document.getElementById('month-selector').selectedOptions[0].text : ''})*

ğŸ“… Ú©Ù„ Ø¯Ù†: ${totalDays}
âœ… Ø­Ø§Ø¶Ø±ÛŒ: ${presentDays} (${totalDays > 0 ? Math.round((presentDays/totalDays)*100) : 0}%)
ğŸ“– Ø³Ø¨Ù‚: ${lessonDays} (${presentDays > 0 ? Math.round((lessonDays/presentDays)*100) : 0}%)
${totalLessonQuantity > 0 ? `ğŸ“ Ú©Ù„ Ø³Ø¨Ù‚ Ù…Ù‚Ø¯Ø§Ø±: ${totalLessonQuantity}\n` : ''}
ğŸ“š Ø³Ø¨Ù‚ÛŒ: ${homeworkDays} (${presentDays > 0 ? Math.round((homeworkDays/presentDays)*100) : 0}%)
${totalHomeworkQuantity > 0 ? `ğŸ“ Ú©Ù„ Ø³Ø¨Ù‚ÛŒ Ù…Ù‚Ø¯Ø§Ø±: ${totalHomeworkQuantity}\n` : ''}
ğŸ¯ Ù…Ù†Ø²Ù„: ${milestoneDays} (${presentDays > 0 ? Math.round((milestoneDays/presentDays)*100) : 0}%)
${totalMilestoneQuantity > 0 ? `ğŸ“ Ú©Ù„ Ù…Ù†Ø²Ù„ Ù…Ù‚Ø¯Ø§Ø±: ${totalMilestoneQuantity}\n` : ''}
            `.trim();
            
            const encodedText = encodeURIComponent(summaryText);
            window.open(`https://wa.me/?text=${encodedText}`, '_blank');
        });
        
        // ÙˆÙ†ÚˆÙˆ Ú©Û’ Ø¨Ø§ÛØ± Ú©Ù„Ú© Ú©Ø±Ù†Û’ Ù¾Ø± Ù…ÙˆÚˆÙ„ Ø¨Ù†Ø¯ ÛÙˆ
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });
        
        // Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
        });
    </script>
</body>
</html>